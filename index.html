<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indica Inc. - Your Online Store</title>
    <link rel="icon" type="image/png" href="static/logo.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        .category-image {
            height: 150px;
        .info-page {
            padding: 1.5rem;
        }

        .info-page h2 {
            font-size: 1.5rem;
        }

        .info-page h3 {
            font-size: 1.1rem;
        }

        .faq-question {
            font-size: 1rem;
        }

        .whatsapp-link {
            display: block;
            text-align: center;
        }

        .category-image {
            height: 150px;
        }

        .category-info {
            padding: 1rem;
        }
        }

        .category-info {
            padding: 1rem;
        }
        }

        :root {
            --primary-color: #87CEEB;
            --primary-dark: #5FA8D3;
            --primary-light: #B0E0E6;
            --text-color: #333;
            --bg-color: #fff;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --success-green: #10B981;
            --trust-blue: #3B82F6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            color: var(--text-color);
            background: #f5f5f5;
        }

        header {
            background: var(--primary-dark);
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: white;
            padding: 5px;
            border-radius: 8px;
            object-fit: contain;
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
        }

        .site-title:hover {
            opacity: 0.9;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .cart-btn {
            background: white;
            color: var(--primary-dark);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cart-count {
            background: #ff4444;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
        }

        nav {
            background: var(--primary-color);
            padding: 0.75rem 0;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            gap: 2rem;
            overflow-x: auto;
        }

        .nav-content a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            white-space: nowrap;
            padding: 0.5rem;
            border-radius: 4px;
            transition: background 0.3s;
        }

        .nav-content a:hover {
            background: rgba(255,255,255,0.2);
        }

        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 20px;
            min-height: 60vh;
        }

        .hero {
            position: relative;
            padding: 0;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 3rem;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.5));
            z-index: 1;
        }

        .hero-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            padding: 4rem 2rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .hero p {
            font-size: 1.2rem;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .category-card {
            background: white;
            padding: 0;
            border-radius: 12px;
            text-align: center;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            color: var(--text-color);
            overflow: hidden;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .category-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }

        .category-info {
            padding: 1.5rem;
        }

        .category-card h3 {
            margin: 0;
            color: var(--primary-dark);
        }

        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background: #f0f0f0;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-info h3 {
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }

        .product-description {
            color: #666;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .price-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }

        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 1rem;
        }

        .discount-badge {
            background: #ff4444;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .add-to-cart-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--primary-dark);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }

        .add-to-cart-btn:hover {
            background: var(--primary-color);
        }

        .product-detail {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .product-detail-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: flex-start;
        }

        .carousel-container {
            position: relative;
            max-width: 100%;
            overflow: hidden;
        }

        .carousel-main {
            width: 100%;
            max-width: 100%;
            height: auto;
            max-height: 600px;
            object-fit: contain;
            display: block;
        }

        .carousel-thumbs {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            overflow-x: auto;
        }

        .carousel-thumb {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border 0.3s;
        }

        .carousel-thumb.active {
            border-color: var(--primary-dark);
        }

        .product-details-info h1 {
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }

        .product-details-info p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .weight-info {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #f0f0f0;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            color: #666;
            font-size: 0.95rem;
        }

        .share-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--trust-blue);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            transition: background 0.3s;
        }

        .share-btn:hover {
            background: #2563EB;
        }

        .share-icon {
            width: 16px;
            height: 16px;
            display: inline-block;
        }

        .product-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 2rem 0;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 1.2rem;
        }

        .quantity-input {
            width: 60px;
            height: 40px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .cart-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .cart-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            overflow-x: auto;
            display: block;
        }

        .cart-table thead,
        .cart-table tbody,
        .cart-table tr {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        .cart-table th,
        .cart-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
            word-wrap: break-word;
        }

        .cart-table th {
            background: var(--primary-light);
            font-weight: bold;
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
        }

        .remove-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .cart-summary {
            text-align: right;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid #ddd;
        }

        .cart-summary-row {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .cart-summary-row.total {
            font-size: 1.5rem;
            font-weight: bold;
            padding-top: 1rem;
            border-top: 1px solid #ddd;
        }

        .cart-weight {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
        }

        .checkout-btn {
            display: block;
            margin: 2rem auto 0;
            padding: 1rem 3rem;
            background: var(--primary-dark);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            max-width: 400px;
        }

        .checkout-container {
            background: white;
            border-radius: 12px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            max-width: 700px;
            margin: 0 auto;
        }

        .checkout-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #f0f0f0;
        }

        .checkout-header h1 {
            color: var(--primary-dark);
            margin-bottom: 0.5rem;
            font-size: 2rem;
        }

        .checkout-header .subtitle {
            color: #666;
            font-size: 1rem;
        }

        .trust-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .trust-item {
            text-align: center;
        }

        .trust-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .trust-text {
            font-size: 0.85rem;
            color: #666;
            font-weight: 500;
        }

        .order-summary-box {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 2rem 0;
        }

        .order-summary-box h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.95rem;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-item.total {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-dark);
            margin-top: 0.5rem;
            padding-top: 1rem;
            border-top: 2px solid var(--primary-dark);
        }

        .cta-section {
            margin: 2.5rem 0;
        }

        .cta-primary {
            width: 100%;
            padding: 1.2rem 2rem;
            background: var(--success-green);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.15rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: all 0.3s;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .cta-primary:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }

        .cta-icon {
            font-size: 1.5rem;
        }

        .cta-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .cta-main {
            font-size: 1.15rem;
        }

        .cta-sub {
            font-size: 0.85rem;
            font-weight: normal;
            opacity: 0.9;
        }

        .urgency-text {
            text-align: center;
            color: #dc2626;
            font-size: 0.9rem;
            margin-top: 1rem;
            font-weight: 500;
        }

        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 2rem 0;
            color: #999;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #ddd;
        }

        .divider span {
            padding: 0 1rem;
            font-size: 0.9rem;
        }

        .help-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }

        .help-section h4 {
            color: var(--text-color);
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .help-section p {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .help-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.85rem 2rem;
            background: white;
            color: var(--primary-dark);
            border: 2px solid var(--primary-dark);
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
        }

        .help-btn:hover {
            background: var(--primary-dark);
            color: white;
        }

        .security-badges {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
            font-size: 0.85rem;
        }

        .security-icon {
            color: var(--success-green);
            font-size: 1.2rem;
        }

        footer {
            background: var(--primary-dark);
            color: white;
            padding: 3rem 0 1rem;
            margin-top: 4rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-logo {
            width: 60px;
            height: 60px;
            background: white;
            padding: 8px;
            border-radius: 8px;
            margin-bottom: 1rem;
            object-fit: contain;
        }

        .footer-section h4 {
            margin-bottom: 1rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .footer-links a:hover {
            opacity: 1;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .product-detail-content {
                grid-template-columns: 1fr;
            }

            .carousel-main {
                max-height: 400px;
            }

            .cart-table {
                font-size: 0.85rem;
            }

            .cart-table th,
            .cart-table td {
                padding: 0.5rem 0.25rem;
            }

            .cart-item-image {
                width: 60px;
                height: 60px;
            }

            .hero {
                min-height: 300px;
            }

            .hero-content {
                padding: 2rem 1.5rem;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .cart-table th:nth-child(1),
            .cart-table td:nth-child(1) {
                width: 35%;
            }

            .cart-table th:nth-child(2),
            .cart-table td:nth-child(2) {
                width: 15%;
            }

            .cart-table th:nth-child(3),
            .cart-table td:nth-child(3) {
                width: 15%;
            }

            .cart-table th:nth-child(4),
            .cart-table td:nth-child(4) {
                width: 18%;
            }

            .cart-table th:nth-child(5),
            .cart-table td:nth-child(5) {
                width: 17%;
            }

            .remove-btn {
                padding: 0.4rem 0.6rem;
                font-size: 0.85rem;
            }

            .checkout-btn {
                padding: 0.875rem 1.5rem;
                font-size: 1rem;
            }

            .checkout-container {
                padding: 1.5rem;
            }

            .checkout-header h1 {
                font-size: 1.5rem;
            }

            .trust-indicators {
                grid-template-columns: 1fr 1fr;
                gap: 1rem;
                padding: 1rem;
            }

            .trust-icon {
                font-size: 1.5rem;
            }

            .trust-text {
                font-size: 0.75rem;
            }

            .cta-primary {
                padding: 1rem 1.5rem;
                font-size: 1rem;
            }

            .cta-main {
                font-size: 1rem;
            }

            .cta-sub {
                font-size: 0.75rem;
            }

            .cart-summary-row {
                flex-direction: column;
                align-items: flex-end;
                gap: 0.5rem;
            }

            .share-btn {
                margin-left: 0;
                margin-top: 0;
            }

            .product-actions {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }

            .weight-info {
                width: 100%;
                justify-content: center;
            }

            .share-btn {
                width: 100%;
                justify-content: center;
            }
        }

        .loading {
            text-align: center;
            padding: 3rem;
            font-size: 1.2rem;
            color: #666;
        }

        .empty-message {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .info-page {
            background: white;
            border-radius: 12px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            max-width: 900px;
            margin: 0 auto;
        }

        .info-page h2 {
            color: var(--primary-dark);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-light);
        }

        .info-page h2:first-child {
            margin-top: 0;
        }

        .info-page h3 {
            color: var(--text-color);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .info-page p, .info-page li {
            line-height: 1.8;
            color: #555;
            margin-bottom: 1rem;
        }

        .info-page ul {
            margin-left: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .info-page li {
            margin-bottom: 0.75rem;
        }

        .info-page strong {
            color: var(--text-color);
        }

        .info-page a {
            color: var(--primary-dark);
            text-decoration: none;
            font-weight: 600;
        }

        .info-page a:hover {
            text-decoration: underline;
        }

        .whatsapp-link {
            display: inline-block;
            background: #25D366;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            margin: 1rem 0;
            font-weight: bold;
        }

        .whatsapp-link:hover {
            background: #1da851;
            text-decoration: none;
        }

        .faq-item {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-weight: bold;
            color: var(--primary-dark);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .faq-answer {
            color: #555;
            line-height: 1.8;
        }

        .back-btn {
            display: inline-block;
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            background: var(--primary-light);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
        }

        .back-btn:hover {
            background: var(--primary-color);
        }
    </style>
</head>
<body>
<header>
    <div class="header-content">
        <div class="logo-container">
            <img src="static/logo.png" alt="Indica Inc. Logo" class="logo" onerror="this.style.display='none'"
                 onclick="showHome()">
            <div class="site-title" onclick="showHome()">Indica Inc.</div>
        </div>
        <div class="header-actions">
            <a href="#" class="cart-btn" onclick="showCart(); return false;">
                üõí Cart <span class="cart-count" id="cartCount">0</span>
            </a>
        </div>
    </div>
</header>

<nav>
    <div class="nav-content" id="navContent">
        <a href="#" onclick="showHome(); return false;">Home</a>
    </div>
</nav>

<main id="mainContent">
    <div class="loading">Loading products...</div>
</main>

<footer>
    <div class="footer-content">
        <div class="footer-section">
            <img src="static/logo.png" alt="Indica Inc. Logo" class="footer-logo" onerror="this.style.display='none'">
            <p>Your trusted online store</p>
        </div>
        <div class="footer-section">
            <h4>Shop</h4>
            <ul class="footer-links" id="footerCategories"></ul>
        </div>
        <div class="footer-section">
            <h4>Customer Service</h4>
            <ul class="footer-links">
                <li><a href="#" onclick="showInfoPage('contact'); return false;">Contact Us</a></li>
                <li><a href="#" onclick="showInfoPage('shipping'); return false;">Shipping Info</a></li>
                <li><a href="#" onclick="showInfoPage('returns'); return false;">Returns</a></li>
                <li><a href="#" onclick="showInfoPage('faq'); return false;">FAQ</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>About</h4>
            <ul class="footer-links">
                <li><a href="#" onclick="showInfoPage('about'); return false;">About Us</a></li>
                <li><a href="#" onclick="showInfoPage('privacy'); return false;">Privacy Policy</a></li>
                <li><a href="#" onclick="showInfoPage('terms'); return false;">Terms of Service</a></li>
            </ul>
        </div>
    </div>
    <div class="footer-content">
        <div class="footer-bottom">
            <p>&copy; 2023 Indica Inc. All rights reserved.</p>
        </div>
    </div>
</footer>

<script>
    let CONFIG = {};
    let products = [];
    let cart = [];
    let categories = [];

    async function init() {
        loadCart();
        await loadConfig();
        await loadDataFromXLSX();

        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('product');
        if (productId && products.length > 0) {
            showProductDetails(productId);
        }
    }

    async function loadConfig() {
        try {
            const response = await fetch('config.json');
            CONFIG = await response.json();
        } catch (e) {
            console.error("Error loading config.json", e);
            CONFIG = {
                upiId: "8802280767@ptsbi",
                merchantName: "Indica Inc",
                whatsappNumber: "917385280767",
                themeColor: "#87CEEB"
            };
        }
    }

    async function loadDataFromXLSX() {
        try {
            const response = await fetch('products.xlsx');
            const arrayBuffer = await response.arrayBuffer();
            const workbook = XLSX.read(arrayBuffer);
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(firstSheet);

            products = jsonData.map(row => ({
                isActive: row['isActive'] == 1,
                itemCode: row['Item Code'] || row['itemCode'],
                itemName: row['Item Name'] || row['itemName'],
                category: row['Category'] || row['category'],
                description: row['Description'] || row['description'],
                price: parseFloat(row['Price'] || row['price']),
                weight: parseFloat(row['Weight'] || row['weight'] || 0),
                isDiscounted: row['Is Discounted'] === 'Yes' || row['isDiscounted'] === true || row['isDiscounted'] == 1,
                discountPercentage: parseFloat(row['Discount Percentage'] || row['discountPercentage'] || 0),
                primaryImage: 'images/' + (row['Primary Image'] || row['primaryImage']),
                secondaryImages: (row['Secondary Images'] || row['secondaryImages'] || '').split(',').map(s => 'images/' + s.trim()).filter(s => s !== 'images/')
            })).filter(p => p.isActive);

            categories = [...new Set(products.map(p => p.category))];
            updateNav();
            updateFooterCategories();

            const urlParams = new URLSearchParams(window.location.search);
            if (!urlParams.get('product')) {
                showHome();
            }
        } catch (error) {
            console.error('Error loading products.xlsx:', error);
            loadSampleData();
        }
    }

    function loadSampleData() {
        products = [
            {
                itemCode: 'BK001',
                itemName: 'The Great Gatsby',
                category: 'Books',
                description: 'A classic novel by F. Scott Fitzgerald set in the Jazz Age',
                price: 599,
                weight: 0.3,
                isDiscounted: true,
                discountPercentage: 20,
                primaryImage: 'images/BK001.jpg',
                secondaryImages: ['images/BK001.jpg']
            },
            {
                itemCode: 'BK002',
                itemName: 'To Kill a Mockingbird',
                category: 'Books',
                description: 'Harper Lee\'s masterpiece about justice and morality',
                price: 450,
                weight: 0.25,
                isDiscounted: false,
                discountPercentage: 0,
                primaryImage: 'images/BK002.jpg',
                secondaryImages: ['images/BK002.jpg']
            }
        ];

        categories = [...new Set(products.map(p => p.category))];
        updateNav();
        updateFooterCategories();
        showHome();
    }

    function updateNav() {
        const nav = document.getElementById('navContent');
        nav.innerHTML = '<a href="#" onclick="showHome(); return false;">Home</a>';
        categories.forEach(cat => {
            nav.innerHTML += `<a href="#" onclick="showCategory('${cat}'); return false;">${cat}</a>`;
        });
    }

    function updateFooterCategories() {
        const footer = document.getElementById('footerCategories');
        footer.innerHTML = categories.map(cat =>
        `<li><a href="#" onclick="showCategory('${cat}'); return false;">${cat}</a></li>`
        ).join('');
    }

    function showHome() {
        window.history.pushState({}, '', window.location.pathname);
        const main = document.getElementById('mainContent');
        main.innerHTML = `
                <div class="hero">
                    <img src="static/indic_celebration.jpg" alt="Indica Inc. Banner" class="hero-image" onerror="this.style.display='none'">
                    <div class="hero-content">
                        <h1>Welcome to Indica Inc.</h1>
                        <p>Discover amazing books at great prices</p>
                    </div>
                </div>
                <h2 style="margin-bottom: 1.5rem;">Shop by Category</h2>
                <div class="category-grid">
                    ${categories.map(cat => `
                        <a href="#" class="category-card" onclick="showCategory('${cat}'); return false;">
                            <img src="static/books-banner.jpg" alt="${cat}" class="category-image" onerror="this.style.display='none'; this.nextElementSibling.style.padding='2rem';">
                            <div class="category-info">
                                <h3>${cat}</h3>
                            </div>
                        </a>
                    `).join('')}
                </div>
            `;
    }

    function showCategory(category) {
        const categoryProducts = products.filter(p => p.category === category);
        const main = document.getElementById('mainContent');
        main.innerHTML = `
                <a href="#" class="back-btn" onclick="showHome(); return false;">‚Üê Back to Home</a>
                <h1 style="margin-bottom: 2rem;">${category}</h1>
                <div class="product-list">
                    ${categoryProducts.map(product => createProductCard(product)).join('')}
                </div>
            `;
    }

    function createProductCard(product) {
        const finalPrice = product.isDiscounted
            ? product.price * (1 - product.discountPercentage / 100)
            : product.price;

        return `
                <div class="product-card" onclick="showProductDetails('${product.itemCode}')">
                    <img src="${product.primaryImage}" alt="${product.itemName}" class="product-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22400%22 height=%22300%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%23999%22%3ENo Image%3C/text%3E%3C/svg%3E'">
                    <div class="product-info">
                        <h3>${product.itemName}</h3>
                        <p class="product-description">${product.description}</p>
                        <div class="price-container">
                            <span class="price">‚Çπ${Math.round(finalPrice)}</span>
                            ${product.isDiscounted ? `
                                <span class="original-price">‚Çπ${product.price}</span>
                                <span class="discount-badge">${product.discountPercentage}% OFF</span>
                            ` : ''}
                        </div>
                        <button class="add-to-cart-btn" onclick="event.stopPropagation(); addToCart('${product.itemCode}')">
                            Add to Cart
                        </button>
                    </div>
                </div>
            `;
    }

    function showProductDetails(itemCode) {
        const product = products.find(p => p.itemCode === itemCode);
        if (!product) return;

        const url = new URL(window.location);
        url.searchParams.set('product', itemCode);
        window.history.pushState({}, '', url);

        const finalPrice = product.isDiscounted
            ? product.price * (1 - product.discountPercentage / 100)
            : product.price;

        const allImages = [product.primaryImage, ...product.secondaryImages.filter(img => img !== product.primaryImage)];
        const main = document.getElementById('mainContent');
        main.innerHTML = `
                <a href="#" class="back-btn" onclick="showCategory('${product.category}'); return false;">‚Üê Back to ${product.category}</a>
                <div class="product-detail">
                    <div class="product-detail-content">
                        <div class="carousel-container">
                            <img src="${product.primaryImage}" alt="${product.itemName}" class="carousel-main" id="carouselMain" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22400%22 height=%22400%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 fill=%22%23999%22%3ENo Image%3C/text%3E%3C/svg%3E'">
                            <div class="carousel-thumbs">
                                ${allImages.map((img, idx) => `
                                    <img src="${img}" alt="${product.itemName}" class="carousel-thumb ${idx === 0 ? 'active' : ''}" onclick="changeCarouselImage('${img}', this)" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23f0f0f0%22 width=%2280%22 height=%2280%22/%3E%3C/svg%3E'">
                                `).join('')}
                            </div>
                        </div>
                        <div class="product-details-info">
                            <h1>${product.itemName}</h1>
                            <p>${product.description}</p>
                            <div class="product-actions">
                                <div class="weight-info">
                                    üì¶ Weight: ${product.weight} kg
                                </div>
                                <button class="share-btn" onclick="shareProduct('${product.itemCode}')">
                                    <svg class="share-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="18" cy="5" r="3"></circle>
                                        <circle cx="6" cy="12" r="3"></circle>
                                        <circle cx="18" cy="19" r="3"></circle>
                                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                                    </svg>
                                    Share
                                </button>
                            </div>
                            <div class="price-container">
                                <span class="price">‚Çπ${Math.round(finalPrice)}</span>
                                ${product.isDiscounted ? `
                                    <span class="original-price">‚Çπ${product.price}</span>
                                    <span class="discount-badge">${product.discountPercentage}% OFF</span>
                                ` : ''}
                            </div>
                            <div class="quantity-selector">
                                <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
                                <input type="number" id="quantityInput" value="1" min="1" class="quantity-input" readonly>
                                <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
                            </div>
                            <button class="add-to-cart-btn" onclick="addToCartWithQuantity('${product.itemCode}')">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `;
    }

    function shareProduct(itemCode) {
        const url = `${window.location.origin}${window.location.pathname}?product=${itemCode}`;

        if (navigator.share) {
            navigator.share({
                title: 'Check out this product!',
                url: url
            }).catch(() => {
                copyToClipboard(url);
            });
        } else {
            copyToClipboard(url);
        }
    }

    function copyToClipboard(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('Product link copied to clipboard!');
    }

    function changeCarouselImage(img, thumb) {
        document.getElementById('carouselMain').src = img;
        document.querySelectorAll('.carousel-thumb').forEach(t => t.classList.remove('active'));
        thumb.classList.add('active');
    }

    function changeQuantity(delta) {
        const input = document.getElementById('quantityInput');
        const newValue = parseInt(input.value) + delta;
        if (newValue >= 1) {
            input.value = newValue;
        }
    }

    function addToCartWithQuantity(itemCode) {
        const quantity = parseInt(document.getElementById('quantityInput').value);
        addToCart(itemCode, quantity);
    }

    function addToCart(itemCode, quantity = 1) {
        const product = products.find(p => p.itemCode === itemCode);
        if (!product) return;

        const existingItem = cart.find(item => item.itemCode === itemCode);
        if (existingItem) {
            existingItem.quantity += quantity;
        } else {
            cart.push({ ...product, quantity });
        }

        saveCart();
        updateCartCount();
        alert('Added to cart!');
    }

    function showCart() {
        if (cart.length === 0) {
            const main = document.getElementById('mainContent');
            main.innerHTML = `
                    <div class="empty-message">
                        <h2>Your cart is empty</h2>
                        <p>Start shopping to add items to your cart</p>
                        <a href="#" class="back-btn" onclick="showHome(); return false;">Continue Shopping</a>
                    </div>
                `;
            return;
        }

        const totalWeight = cart.reduce((sum, item) => sum + (item.weight * item.quantity), 0);

        const main = document.getElementById('mainContent');
        main.innerHTML = `
                <a href="#" class="back-btn" onclick="showHome(); return false;">‚Üê Continue Shopping</a>
                <div class="cart-container">
                    <h1>Shopping Cart</h1>
                    <table class="cart-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Subtotal</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${cart.map(item => {
            const finalPrice = item.isDiscounted
                ? item.price * (1 - item.discountPercentage / 100)
                : item.price;
            const subtotal = finalPrice * item.quantity;

            return `
                                    <tr>
                                        <td>
                                            <div style="display: flex; align-items: center; gap: 1rem;">
                                                <img src="${item.primaryImage}" class="cart-item-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23f0f0f0%22 width=%2280%22 height=%2280%22/%3E%3C/svg%3E'">
                                                <div>
                                                    <strong>${item.itemName}</strong>
                                                    <br>
                                                    <small>${item.category}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td>‚Çπ${Math.round(finalPrice)}</td>
                                        <td>${item.quantity}</td>
                                        <td><strong>‚Çπ${Math.round(subtotal)}</strong></td>
                                        <td>
                                            <button class="remove-btn" onclick="removeFromCart('${item.itemCode}')">Remove</button>
                                        </td>
                                    </tr>
                                `;
        }).join('')}
                        </tbody>
                    </table>
                    <div class="cart-summary">
                        <div class="cart-summary-row">
                            <span>Total Items:</span>
                            <strong>${cart.reduce((sum, item) => sum + item.quantity, 0)}</strong>
                        </div>
                        <div class="cart-summary-row">
                            <span class="cart-weight">‚öñÔ∏è Total Weight:</span>
                            <strong>${totalWeight.toFixed(2)} kg</strong>
                        </div>
                        <div class="cart-summary-row total">
                            <span>Order Total:</span>
                            <span>‚Çπ${Math.round(calculateTotal())}</span>
                        </div>
                    </div>
                    <button class="checkout-btn" onclick="showCheckout()">Proceed to Checkout</button>
                </div>
            `;
    }

    function removeFromCart(itemCode) {
        cart = cart.filter(item => item.itemCode !== itemCode);
        saveCart();
        updateCartCount();
        showCart();
    }

    function calculateTotal() {
        return cart.reduce((total, item) => {
            const finalPrice = item.isDiscounted
                ? item.price * (1 - item.discountPercentage / 100)
                : item.price;
            return total + (finalPrice * item.quantity);
        }, 0);
    }

    function showCheckout() {
        const total = calculateTotal();
        const totalWeight = cart.reduce((sum, item) => sum + (item.weight * item.quantity), 0);
        const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);

        const orderItems = cart.map(item => {
            const finalPrice = item.isDiscounted
                ? item.price * (1 - item.discountPercentage / 100)
                : item.price;
            return `${item.itemName} (Quantity: ${item.quantity}) - Rs ${Math.round(finalPrice * item.quantity)}`;
        }).join('%0A');

        const whatsappMessage = `Hello!%0A%0AI would like to place an order for the following items:%0A%0A${orderItems}%0A%0A------------------------%0A%0AOrder Total: Rs ${Math.round(total)}%0ATotal Weight: ${totalWeight.toFixed(2)} kg%0ATotal Items: ${itemCount}%0A%0A------------------------%0A%0AMy Delivery Details:%0A%0AName: %0APhone Number: %0AComplete Address: %0ACity: %0APincode: %0A%0AThank you!`;
        const whatsappUrl = `https://wa.me/${CONFIG.whatsappNumber}?text=${whatsappMessage}`;

        const helpOrderItems = cart.map(item => {
            const finalPrice = item.isDiscounted
                ? item.price * (1 - item.discountPercentage / 100)
                : item.price;
            return `${item.itemName} (Quantity: ${item.quantity}) - Rs ${Math.round(finalPrice * item.quantity)}`;
        }).join('%0A');

        const helpWhatsappMessage = `Hello!%0A%0AI need some help with my order.%0A%0AMy Cart Details:%0A%0A${helpOrderItems}%0A%0A------------------------%0A%0ACart Total: Rs ${Math.round(total)}%0ATotal Weight: ${totalWeight.toFixed(2)} kg%0ATotal Items: ${itemCount}%0A%0A------------------------%0A%0ACould you please assist me?%0A%0AThank you!`;
        const helpWhatsappUrl = `https://wa.me/${CONFIG.whatsappNumber}?text=${helpWhatsappMessage}`;

        const main = document.getElementById('mainContent');
        main.innerHTML = `
                <div class="checkout-container">
                    <div class="checkout-header">
                        <h1>üéâ Almost There!</h1>
                        <p class="subtitle">Complete your order in just one simple step</p>
                    </div>

                    <div class="trust-indicators">
                        <div class="trust-item">
                            <div class="trust-icon">üîí</div>
                            <div class="trust-text">Secure Payment</div>
                        </div>
                        <div class="trust-item">
                            <div class="trust-icon">‚úÖ</div>
                            <div class="trust-text">Verified Seller</div>
                        </div>
                        <div class="trust-item">
                            <div class="trust-icon">üì¶</div>
                            <div class="trust-text">Fast Delivery</div>
                        </div>
                        <div class="trust-item">
                            <div class="trust-icon">üíØ</div>
                            <div class="trust-text">Quality Assured</div>
                        </div>
                    </div>

                    <div class="order-summary-box">
                        <h3>üìã Your Order Summary</h3>
                        ${cart.map(item => {
            const finalPrice = item.isDiscounted
                ? item.price * (1 - item.discountPercentage / 100)
                : item.price;
            return `
                                <div class="summary-item">
                                    <span>${item.itemName} √ó ${item.quantity}</span>
                                    <strong>‚Çπ${Math.round(finalPrice * item.quantity)}</strong>
                                </div>
                            `;
        }).join('')}
                        <div class="summary-item">
                            <span>‚öñÔ∏è Total Weight</span>
                            <strong>${totalWeight.toFixed(2)} kg</strong>
                        </div>
                        <div class="summary-item total">
                            <span>Order Total</span>
                            <span>‚Çπ${Math.round(total)}</span>
                        </div>
                    </div>

                    <div class="cta-section">
                        <a href="${whatsappUrl}" class="cta-primary" target="_blank">
                            <span class="cta-icon">‚úÖ</span>
                            <div class="cta-text">
                                <div class="cta-main">Confirm Order on WhatsApp</div>
                                <div class="cta-sub">Quick, Easy & Secure</div>
                            </div>
                        </a>
                        <p class="urgency-text">‚è∞ Complete your order now to ensure availability!</p>
                    </div>

                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin: 2rem 0;">
                        <h4 style="color: var(--primary-dark); margin-bottom: 1rem; text-align: center;">üì± How It Works</h4>
                        <div style="display: grid; gap: 1rem;">
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: var(--success-green); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</div>
                                <div>
                                    <strong>Click the button above</strong>
                                    <p style="color: #666; font-size: 0.9rem; margin-top: 0.25rem;">WhatsApp will open with your order details pre-filled</p>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: var(--success-green); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</div>
                                <div>
                                    <strong>Add your delivery address</strong>
                                    <p style="color: #666; font-size: 0.9rem; margin-top: 0.25rem;">Fill in your name, phone, and complete address</p>
                                </div>
                            </div>
                            <div style="display: flex; align-items: start; gap: 1rem;">
                                <div style="background: var(--success-green); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</div>
                                <div>
                                    <strong>Send the message</strong>
                                    <p style="color: #666; font-size: 0.9rem; margin-top: 0.25rem;">We'll confirm your order and share payment details</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="divider">
                        <span>Need Help?</span>
                    </div>

                    <div class="help-section">
                        <h4>üí¨ Have Questions?</h4>
                        <p>Our customer support team is here to help! Chat with us on WhatsApp for instant assistance with your order.</p>
                        <a href="${helpWhatsappUrl}" class="help-btn" target="_blank">
                            <span>üí≠</span>
                            <span>Chat with Support</span>
                        </a>
                    </div>

                    <div class="security-badges">
                        <div class="security-badge">
                            <span class="security-icon">‚úì</span>
                            <span>100% Secure</span>
                        </div>
                        <div class="security-badge">
                            <span class="security-icon">‚úì</span>
                            <span>Easy Returns</span>
                        </div>
                        <div class="security-badge">
                            <span class="security-icon">‚úì</span>
                            <span>Trusted by 1000+ Customers</span>
                        </div>
                    </div>
                </div>
            `;
    }

    function saveCart() {
        const cartData = JSON.stringify(cart);
        window.cartData = cartData;
    }

    function loadCart() {
        try {
            const cartData = window.cartData || '[]';
            cart = JSON.parse(cartData);
            updateCartCount();
        } catch (e) {
            cart = [];
        }
    }

    function updateCartCount() {
        const count = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById('cartCount').textContent = count;
    }

    function showInfoPage(section) {
        window.scrollTo(0, 0);
        const main = document.getElementById('mainContent');

        const contactEmail = 'indicastore.help@gmail.com';
        const whatsappMsg = encodeURIComponent("Hi! I'd like to know more about your books. Could you please help me?");
        const whatsappUrl = `https://wa.me/${CONFIG.whatsappNumber}?text=${whatsappMsg}`;

        let content = '';

        if (section === 'contact') {
            content = `
                <h2>ü§ù Contact Us</h2>
                <p><strong>Need help or have questions?</strong></p>
                <p>We're here to help! The fastest way to reach us is through WhatsApp. Our team typically responds within a few hours during business days.</p>
                <a href="${whatsappUrl}" class="whatsapp-link" target="_blank">üí¨ Chat with us on WhatsApp</a>
                <p>You can also email us at: <strong><a href="mailto:${contactEmail}">${contactEmail}</a></strong></p>
                <p>Our business hours: Monday to Saturday, 10 AM - 7 PM IST</p>
            `;
        } else if (section === 'shipping') {
            content = `
                <h2>üì¶ Shipping Information</h2>
                <h3>How we ship your orders:</h3>
                <p>We work with multiple shipping partners including India Post, Delhivery, DTDC, and local courier services to get your books to you safely and affordably.</p>

                <h3>How it works:</h3>
                <ul>
                    <li>We choose the best shipping partner based on your location, current weather conditions, traffic situations, and seasonal demand</li>
                    <li>This helps us offer you the most reliable delivery at the best possible price</li>
                    <li>Shipping charges vary based on your location and package weight</li>
                    <li><strong>We'll share the exact shipping cost with you before we dispatch your order</strong> - no surprises!</li>
                    <li>Once shipped, you'll receive tracking information via WhatsApp</li>
                </ul>

                <h3>Delivery time:</h3>
                <ul>
                    <li>Metro cities: 3-5 business days</li>
                    <li>Other cities: 5-7 business days</li>
                    <li>Remote areas: 7-10 business days</li>
                </ul>

                <p><em>Note: During festive seasons or adverse weather, deliveries may take a bit longer. We appreciate your patience!</em></p>
            `;
        } else if (section === 'returns') {
            content = `
                <h2>üîÑ Returns & Refunds</h2>
                <p><strong>Yes, we accept returns!</strong> We want you to be happy with your purchase.</p>

                <h3>Our return policy:</h3>

                <p><strong>‚úì Return window:</strong> You can return items within 7 days of delivery</p>

                <p><strong>‚úì Condition requirements:</strong></p>
                <ul>
                    <li>Books must be in the same condition as described in the listing</li>
                    <li>If the book condition is significantly different from what we described, we'll gladly accept the return</li>
                    <li>No additional damage should occur after delivery (new marks, tears, stains, etc.)</li>
                    <li>Original packaging preferred (but not mandatory if you've discarded it)</li>
                </ul>

                <p><strong>‚úì Return shipping:</strong> Customer bears the return shipping cost - you can use any courier service you prefer</p>

                <p><strong>‚úì How to initiate a return:</strong></p>
                <ol>
                    <li>Contact us on WhatsApp within 7 days of receiving your order</li>
                    <li>Share photos of the product and explain the issue</li>
                    <li>We'll confirm and share our return address</li>
                    <li>Ship the item back to us</li>
                    <li>Once we receive and verify the condition, we'll process your refund</li>
                </ol>

                <p><strong>‚úì Refund process:</strong></p>
                <ul>
                    <li>Refunds are processed within 3-5 business days after we receive the returned item</li>
                    <li>Money will be refunded to your original payment method (UPI/bank account)</li>
                </ul>

                <p><strong>‚úì Non-returnable items:</strong></p>
                <ul>
                    <li>Books with new damage caused after delivery</li>
                    <li>Books that match the condition described in our listing</li>
                    <li>Sale or clearance items marked "Final Sale"</li>
                </ul>

                <p><strong>No hard feelings!</strong> We understand that sometimes a book isn't what you expected, especially if the condition doesn't match our description. We're a small business doing our best to keep our customers happy, and we take full responsibility if we've misrepresented any item.</p>
            `;
        } else if (section === 'faq') {
            content = `
                <h2>‚ùì Frequently Asked Questions</h2>

                <div class="faq-item">
                    <div class="faq-question">1. Are all your books authentic?</div>
                    <div class="faq-answer">Yes, absolutely! We only sell genuine books. All our books are pre-loved and carefully selected for quality. We never deal in pirated or counterfeit copies.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">2. How do you describe book conditions?</div>
                    <div class="faq-answer">We carefully inspect and describe the condition of every book in the product listing. This includes notes about cover condition, page quality, markings, highlights, or any wear and tear. What you see in the description is exactly what you'll receive.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">3. Can I order books not listed on your website?</div>
                    <div class="faq-answer">Possibly! If you're looking for a specific title, send us a message on WhatsApp with the book name and author. We'll check our inventory and let you know if we have it or can source it for you, along with pricing and delivery time.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">4. How do I track my order?</div>
                    <div class="faq-answer">Once your order is shipped, we'll send you the tracking number and courier partner details via WhatsApp. You can track your package on the courier's website or app.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">5. What payment methods do you accept?</div>
                    <div class="faq-answer">Currently, we accept UPI payments (Google Pay, PhonePe, Paytm, etc.). We share our UPI ID during the order confirmation process on WhatsApp.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">6. Do you ship all over India?</div>
                    <div class="faq-answer">Yes! We ship to all serviceable PIN codes across India. If you're in a remote location, please confirm with us on WhatsApp before placing your order, and we'll check serviceability.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">7. My book arrived in worse condition than described. What should I do?</div>
                    <div class="faq-answer">We sincerely apologize if that happens! Please take photos immediately and contact us on WhatsApp within 24 hours. If the book condition doesn't match our description, we'll arrange a replacement or full refund at no extra cost to you. We take our condition descriptions seriously.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">8. My book arrived damaged during shipping. What should I do?</div>
                    <div class="faq-answer">We're sorry to hear that! Please don't accept the delivery if the package looks damaged. If you've already accepted it, take photos immediately and contact us on WhatsApp within 24 hours. We'll arrange a replacement or full refund.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">9. Can I cancel my order?</div>
                    <div class="faq-answer">Yes, you can cancel before we ship. Once shipped, you'll need to follow the return process. Contact us on WhatsApp as soon as possible if you want to cancel.</div>
                </div>

                <p style="margin-top: 2rem;"><strong>Still have questions?</strong></p>
                <p>No problem! Just reach out to us on WhatsApp or email us at <a href="mailto:${contactEmail}">${contactEmail}</a> - we're always happy to help.</p>
            `;
        } else if (section === 'about') {
            content = `
                <h2>üìö About Indica Inc.</h2>
                <p>Welcome to Indica Inc., your trusted source for quality pre-loved books!</p>
                <p>We're passionate book lovers dedicated to giving great books a second life. Every book in our collection is carefully selected, inspected, and honestly described so you know exactly what you're getting.</p>
                <p>Our mission is simple: to make quality reading affordable and accessible while promoting sustainable consumption. By giving books a second home, we're not just saving you money - we're helping the environment too.</p>
                <p>Thank you for supporting our small business and happy reading!</p>
            `;
        } else if (section === 'privacy') {
            content = `
                <h2>üîí Privacy Policy</h2>
                <p>At Indica Inc., we respect your privacy and are committed to protecting your personal information.</p>

                <h3>Information We Collect:</h3>
                <ul>
                    <li>Name, phone number, and delivery address for order fulfillment</li>
                    <li>Payment information (processed securely through UPI)</li>
                    <li>Communication history via WhatsApp and email</li>
                </ul>

                <h3>How We Use Your Information:</h3>
                <ul>
                    <li>To process and deliver your orders</li>
                    <li>To communicate with you about your orders</li>
                    <li>To improve our service</li>
                </ul>

                <h3>Information Security:</h3>
                <p>We never share your personal information with third parties except for shipping partners necessary to deliver your order. Your data is stored securely and used only for business purposes.</p>

                <p>For any privacy concerns, please contact us at <a href="mailto:${contactEmail}">${contactEmail}</a></p>
            `;
        } else if (section === 'terms') {
            content = `
                <h2>üìã Terms of Service</h2>

                <h3>By using our website and services, you agree to:</h3>

                <p><strong>Orders and Payments:</strong></p>
                <ul>
                    <li>All orders are confirmed via WhatsApp</li>
                    <li>Payment must be made before shipping</li>
                    <li>Prices and availability are subject to change</li>
                </ul>

                <p><strong>Product Descriptions:</strong></p>
                <ul>
                    <li>We strive for accurate descriptions of book conditions</li>
                    <li>All books are pre-owned unless otherwise stated</li>
                    <li>Photos are representative; actual items may vary slightly</li>
                </ul>

                <p><strong>Shipping and Delivery:</strong></p>
                <ul>
                    <li>Delivery times are estimates and not guaranteed</li>
                    <li>We're not responsible for courier delays beyond our control</li>
                    <li>Risk of loss passes to you upon delivery</li>
                </ul>

                <p><strong>Returns:</strong></p>
                <ul>
                    <li>See our Returns & Refunds policy for details</li>
                    <li>We reserve the right to refuse returns that don't meet our policy criteria</li>
                </ul>

                <p><strong>Limitation of Liability:</strong></p>
                <p>As a small business, we do our best but cannot be held liable for indirect damages or losses. Our maximum liability is limited to the purchase price of the product.</p>

                <p>For questions about these terms, contact us at <a href="mailto:${contactEmail}">${contactEmail}</a></p>
            `;
        }

        main.innerHTML = `
            <a href="#" class="back-btn" onclick="showHome(); return false;">‚Üê Back to Home</a>
            <div class="info-page">
                ${content}
            </div>
        `;
    }

    init();
</script>
</body>
</html>